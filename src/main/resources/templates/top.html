<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<title>宿へようこそ</title>
	<!-- フォントやアイコンなどの読み込み -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&display=swap" rel="stylesheet">
	<!-- Font Awesome -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
	<!-- 共通CSS -->
	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/css/shadow.css">
	<link rel="stylesheet" href="/css/header-footer.css">
	<!--ここまで共通-->

	<link rel="stylesheet" href="/css/top-style.css">
	<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />

	<style>
		/* 追加や一時的な上書きはここに記載 */
	</style>
</head>

<body>
	<header th:replace="header"></header>

	<main>
		<!-- ================== 検索フォーム ================== -->
		<div class="search-form-outer">
			<div class="search-form-wrap">
				<form class="search-form-box" action="/room" method="get">
					<div class="">
						<!-- キーワード検索（ルーム名で検索） -->
						<p>●キーワード検索</p>
						<input type="text" name="keyword" th:value="${keyword}" placeholder="ルーム名検索"
							class="keyword-search">

						<!-- 部屋タイプ選択（チェックボックス） -->
						<div class="room-type-group">
							<p>●部屋タイプ</p>
							<div class="room-type-center">
								<label>
									<input type="checkbox" name="types" value="1"
										th:checked="${types != null and types.contains(1)}">スイートルーム
								</label>
								<label>
									<input type="checkbox" name="types" value="2"
										th:checked="${types != null and types.contains(2)}">ダブルルーム
								</label>
								<label>
									<input type="checkbox" name="types" value="3"
										th:checked="${types != null and types.contains(3)}">シングルルーム
								</label>
							</div>
						</div>

						<!-- 予算ブロック（下限・上限入力＋スライダー） -->
						<div class="room-price-group">
							<p>●予算</p>
							<div class="contanabox">
								<div class="price-display">
									<div class="price-box">
										<div class="price-label">下限</div>
										<div class="price-value">¥<span>
												<input type="text" id="under_value_display"
													style="border: none; width:80%; outline: none;">
											</span></div>
									</div>
									<span class="price-separator">～</span>
									<div class="price-box">
										<div class="price-label">上限</div>
										<div class="price-value">¥<span>
												<input type="text" id="up_value_display"
													style="border: none; width:80%; outline: none;">
											</span></div>
									</div>
								</div>
								<div class="slider-contanabox">
									<div class="slider-track"></div>
									<div class="slider-range" id="slider-range"></div>
									<!-- 2本のスライダー -->
									<input type="range" id="pi_under_input" class="slider-lower" min="0" max="100000"
										name="underPrice" th:value="${underPrice}" step="1">
									<input type="range" id="pi_up_input" class="slider-upper" min="0" max="100000"
										name="upPrice" th:value="${upPrice}" step="1">
								</div>
								<!-- 送信用hidden -->
								<input type="hidden" id="under_value_input" name="underPrice" th:value="${underPrice}">
								<input type="hidden" id="up_value_input" name="upPrice" th:value="${upPrice}">
							</div>
						</div>

						<!-- チェックイン・チェックアウト -->
						<div class="calendar-group">
							<div class="calendar-label-row">
								<p>●チェックイン・チェックアウト</p>
							</div>
							<div class="calendar-input-row">
								<div class="calendar-input-wrap calendar-checkin-wrap">
									<span class="material-symbols-outlined">calendar_month</span>
									<input type="text" id="checkinDate" name="checkinDate" th:value="${checkinDate}"
										required readonly>
									<!-- カレンダー本体(絶対位置でinput直下) -->
									<div id="calendarArea">
										<div class="calendar-nav-row">
											<button type="button" class="calendar-nav-btn calendar-nav-prev"
												id="prev">&lt;</button>
											<div class="calendar-nav-space"></div>
											<button type="button" class="calendar-nav-btn calendar-nav-next"
												id="next">&gt;</button>
										</div>
										<!-- ここが複数月分、横並びで生成される -->
										<div id="calendar"></div>
										<button type="button" id="closeCalendar">閉じる</button>
									</div>
								</div>
								<span class="calendar-tilde">～</span>
								<div class="calendar-input-wrap">
									<span class="material-symbols-outlined">calendar_month</span>
									<input type="text" id="checkoutDate" name="checkoutDate" th:value="${checkoutDate}"
										required readonly>
								</div>
							</div>
						</div>
						<!-- 検索ボタン -->
						<div class="search-btn-wrap" style="text-align: center;">
							<button type="submit" class="search-btn">検索する</button>
						</div>
					</div>
				</form>
			</div>
		</div>

		<!-- ================== 部屋リスト ================== -->
		<section class="rooms-section">
			<h2 class="section-title">客室のご案内</h2>
			<p class="section-subtitle">全ての客室から絶景のオーシャンビューをお楽しみいただけます</p>
			<div class="rooms-grid">
				<!-- ▼ ここからルームカード（繰り返し） -->
				<div class="room-card" th:each="room : ${rooms}" th:id="${room.id}">
					<a
						th:href="@{/rooms/{roomId}(roomId=${room.id}, checkinDate=${checkinDate}, checkoutDate=${checkoutDate})}">
						<!-- 部屋画像 -->
						<img th:src="@{${room.imgPath}}" alt="部屋" class="room-card-image">

						<div class="room-card-content">
							<!-- 部屋名＋タイプ -->
							<div class="room-card-header">
								<span class="room-card-title" th:text="${room.roomName}"></span>
								<span class="room-card-type" th:text="${room.type.typeName}"></span>
							</div>
							<!-- 部屋説明 -->
							<div class="room-card-desc" th:text="${room.description}"></div>

							<!-- 金額＆星マークを横並びで説明のすぐ下に配置 -->
							<div class="room-card-row-horizontal">
								<!-- 金額（左寄せ） -->
								<span class="room-card-price"
									th:text="'¥' + ${#numbers.formatInteger(room.price, 3, 'COMMA')} + '〜 / 泊'">
									¥35,000〜 / 泊
								</span>
								<!-- いいね(星)ボタン（右端） -->
								<a th:href="@{/like/{roomId}/like(roomId=${room.id})}" class="like-link">

									<a th:href="@{/rooms/{roomId}/like(roomId=${room.id})}" class="like-link">
										<i th:if="${like.contains(room.id)}" class="fa-solid fa-heart"></i>
										<i th:unless="${like.contains(room.id)}" class="fa-regular fa-heart"></i>
									</a>
							</div>
						</div>
					</a>

				</div>
				<!-- ▲ ここまでルームカード -->
			</div>
		</section>
	</main>
	<footer th:replace="footer"></footer>
	<script src="/js/range.js"></script>
	<script src="/js/calendar.js"></script>
</body>

</html>